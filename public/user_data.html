<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Logged In</title>
  <div id="test123"></div>
</head>
<body>
<button id='generateToken'>Get User Token</button>
</body>
<script src="https://www.gstatic.com/firebasejs/7.4.0/firebase.js"></script>
<script type="text/javascript">
const firebaseConfig = {
  apiKey: "AIzaSyBfQKMxa1azXidOZJjT8UYDm5BnU4s2bKA",
  authDomain: "step95-2020.firebaseapp.com",
  databaseURL: "https://step95-2020.firebaseio.com",
  projectId:"step95-2020",
  storageBucket: "step95-2020.appspot.com",
  messagingSenderId: "525367632678",
  appId: "1:525367632678:web:476053e80e5f22c6f417e7",
  measurementId: "G-QJE1CBXKGN"
};
firebase.initializeApp(firebaseConfig);
document.getElementById('generateToken').addEventListener("click", generateToken);
console.log('eyJhbGciOiJSUzI1NiIsImtpZCI6IjZjZmMyMzViZDYxMGZhY2FlYzVlYjBhZGU5NTg5ZGE5NTI4MmRlY2QiLCJ0eXAiOiJKV1QifQ.eyJuYW1lIjoiTmVyaXlhaCBCdXRsZXIiLCJwaWN0dXJlIjoiaHR0cHM6Ly9saDMuZ29vZ2xldXNlcmNvbnRlbnQuY29tL2EtL0FPaDE0R2dGbWJyT0t0cEQxMWt4YnJkanlKdGxWWWhrWlpfZFBOZV9YTGVDIiwiaXNzIjoiaHR0cHM6Ly9zZWN1cmV0b2tlbi5nb29nbGUuY29tL3N0ZXA5NS0yMDIwIiwiYXVkIjoic3RlcDk1LTIwMjAiLCJhdXRoX3RpbWUiOjE1OTUzNTgwMzMsInVzZXJfaWQiOiJsZVBYbmUwYlNoUW9oR0pwNGdwbllvSTA4NHUyIiwic3ViIjoibGVQWG5lMGJTaFFvaEdKcDRncG5Zb0kwODR1MiIsImlhdCI6MTU5NTM1ODAzNSwiZXhwIjoxNTk1MzYxNjM1LCJlbWFpbCI6Im56YnV0bGVyQGdvb2dsZS5jb20iLCJlbWFpbF92ZXJpZmllZCI6dHJ1ZSwiZmlyZWJhc2UiOnsiaWRlbnRpdGllcyI6eyJnb29nbGUuY29tIjpbIjExNDkwODE5Njc0MzAxNDEzNjg2NCJdLCJlbWFpbCI6WyJuemJ1dGxlckBnb29nbGUuY29tIl19LCJzaWduX2luX3Byb3ZpZGVyIjoiZ29vZ2xlLmNvbSJ9fQ.MkSVMS9UTldGwRAQHKiA4u-jXJgdyB8n9xBphCY1_68uI2H6hjEj6q6fUx_Z99870xCYRNE8sSBc6Lp3gPXcFQfzUvT244IhzyCHva5K79fRnkxj3Z6DFjx61U84z1rLM_cVg5uDjaP3be-xx9hMFS9QqYgCLtj2Zo77mNq46gpgg9vcHijT-Pz8iel764QWAiGNi7xm_ehchPYDYYlNfzWoNJvQAY2Ol0khrVPa7Wdqz_3xYnXdjuuKi3MV8A5ea1fOrdKSA3X_iBad_51NBweEfGJvflDOKQowT0mVaWLppsV9cU4jBa-8srXlJCV8WzHHGO8Ov4J4XmNVaMtpXQ'.length);
 
function generateToken() {
  firebase.auth().onAuthStateChanged(function(user) {
    if (user.email != null){
      firebase.auth().currentUser.getIdToken(true).then(function(idToken) {
        document.getElementById("test123").innerHTML = idToken;
        var data = {'token' : idToken};
      
        const options = {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(data)
        };
        fetch('/data', options);
      }).catch(function(error) {
        console.log(error);
      });
    } else {
 
      var data = {'token' : 'error'};
      const options = {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify(data)
      };
      document.getElementById("test123").innerHTML = "not logged in";
      fetch('/data', options);
      }
  });
}
</script>
</html>
 
 

